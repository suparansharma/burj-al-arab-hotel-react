{"ast":null,"code":"var _jsxFileName = \"C:\\\\Web Development\\\\React\\\\burj-al-arab-hotel-react\\\\src\\\\components\\\\Login\\\\Login.js\";\nimport React, { useContext } from 'react';\nimport { useState } from 'react';\nimport { initializeApp } from \"firebase/app\"; // firebase.initializeApp({ ... })\n\nimport firebaseConfig from \"./firebase.config\";\nimport { GoogleAuthProvider, getAuth, signInWithPopup, signOut, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile, FacebookAuthProvider } from \"firebase/auth\";\nimport { UserContext } from '../../App';\nimport { useHistory, useLocation } from 'react-router-dom'; // import * as firebase from 'firebase/app'\n\nconst Login = () => {\n  const [newUser, setNewUser] = useState(false);\n  const [user, setUser] = useState({\n    isSignedIn: false,\n    // newUser:false,\n    name: \"\",\n    email: \"\",\n    password: \"\",\n    photo: \"\"\n  });\n  const [loggedInUser, setLoggedInUser] = useContext(UserContext);\n  const history = useHistory();\n  const location = useLocation();\n  const app = initializeApp(firebaseConfig);\n  const auth = getAuth(app);\n  const Googleprovider = new GoogleAuthProvider();\n  const Fbprovider = new FacebookAuthProvider();\n\n  const googleSignIn = () => {\n    signInWithPopup(auth, Googleprovider).then(result => {\n      const {\n        displayName,\n        email,\n        photoURL\n      } = result.user;\n      const signedInUser = {\n        isSignedIn: true,\n        name: displayName,\n        email: email,\n        photo: photoURL\n      };\n      setUser(signedInUser);\n      setLoggedInUser(signedInUser);\n      console.log(displayName, email, photoURL); // const credential = GoogleAuthProvider.credentialFromResult(result);\n      // const token = credential.accessToken;\n      // const user = result.user;\n    }).catch(error => {\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      const email = error.customData.email;\n      const credential = GoogleAuthProvider.credentialFromError(error);\n      console.log(errorMessage);\n    });\n  };\n\n  const googleSignOut = () => {\n    signOut(auth).then(result => {\n      // const { displayName, email, photoURL } = result.user;\n      const signedOutUser = {\n        isSignedIn: false,\n        name: \"\",\n        email: \"\",\n        photo: \"\",\n        error: \"\",\n        success: false\n      };\n      setUser(signedOutUser);\n    });\n  };\n\n  const handleBlur = event => {\n    let isFieldValid = true;\n\n    if (event.target.name === \"email\") {\n      isFieldValid = /\\S+@\\S+\\.\\S+/.test(event.target.value);\n    }\n\n    if (event.target.name === \"password\") {\n      const isPasswordValid = event.target.value.length > 0;\n      const passwordHasNumber = /\\d{1}/.test(event.target.value);\n      isFieldValid = isPasswordValid && passwordHasNumber;\n    }\n\n    if (isFieldValid) {\n      const newUserInfo = { ...user\n      };\n      newUserInfo[event.target.name] = event.target.value;\n      setUser(newUserInfo);\n    }\n  };\n\n  const handleSubmit = event => {\n    if (newUser && user.email && user.password) {\n      const auth = getAuth();\n      console.log(user.email, user.password, \"subbmit\");\n      createUserWithEmailAndPassword(auth, user.email, user.password).then(res => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = \"\";\n        newUserInfo.success = true;\n        setUser(newUserInfo);\n        updateUserName(user.name);\n        console.log(res);\n      }).catch(error => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = error.message;\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n\n    if (!newUser && user.email && user.password) {\n      const auth = getAuth();\n      signInWithEmailAndPassword(auth, user.email, user.password).then(userCredential => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = \"\";\n        newUserInfo.success = true;\n        setUser(newUserInfo);\n        setLoggedInUser(newUserInfo);\n      }).catch(error => {\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = error.message;\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n\n    event.preventDefault();\n  };\n\n  const updateUserName = name => {\n    const auth = getAuth();\n    updateProfile(auth.currentUser, {\n      displayName: name\n    }).then(function () {\n      console.log(\"user name updated successfully\");\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const fbSignIn = () => {\n    const auth = getAuth();\n    signInWithPopup(auth, Fbprovider).then(result => {\n      // The signed-in user info.\n      const user = result.user; // This gives you a Facebook Access Token. You can use it to access the Facebook API.\n\n      const credential = FacebookAuthProvider.credentialFromResult(result);\n      const accessToken = credential.accessToken;\n      console.log(user); // ...\n    }).catch(error => {\n      // Handle Errors here.\n      const errorCode = error.code;\n      const errorMessage = error.message; // The email of the user's account used.\n\n      const email = error.customData.email; // The AuthCredential type that was used.\n\n      const credential = FacebookAuthProvider.credentialFromError(error); // ...\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 7\n    }\n  }, user.isSignedIn ? /*#__PURE__*/React.createElement(\"button\", {\n    onClick: googleSignOut,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 11\n    }\n  }, \"Sign Out\") : /*#__PURE__*/React.createElement(\"button\", {\n    onClick: googleSignIn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 11\n    }\n  }, \"Sign In\"), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: fbSignIn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  }, \"Sign In Using Facebook\"), user.isSignedIn && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 13\n    }\n  }, \"Welcome, \", user.name), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 13\n    }\n  }, \"Your email:\", user.email), /*#__PURE__*/React.createElement(\"img\", {\n    src: user.photo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"checkbox\",\n    onChange: () => !setNewUser(!newUser),\n    name: \"newUser\",\n    id: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"newUser\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 9\n    }\n  }, \"New User Sign up\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 9\n    }\n  }, newUser && /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    onBlur: handleBlur,\n    placeholder: \"Your Name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 22\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 89\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    onBlur: handleBlur,\n    name: \"email\",\n    id: \"\",\n    placeholder: \"Your Email addresss\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"password\",\n    onChange: handleBlur,\n    name: \"password\",\n    id: \"\",\n    placeholder: \"Your Password\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"submit\",\n    value: newUser ? 'Sign up' : 'Sign In',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    style: {\n      color: \"red\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 9\n    }\n  }, user.error), user.success && /*#__PURE__*/React.createElement(\"p\", {\n    style: {\n      color: \"green\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 26\n    }\n  }, \"User \", newUser ? 'created' : 'Logged In', \" Created successfully\"));\n};\n\nexport default Login;","map":{"version":3,"sources":["C:/Web Development/React/burj-al-arab-hotel-react/src/components/Login/Login.js"],"names":["React","useContext","useState","initializeApp","firebaseConfig","GoogleAuthProvider","getAuth","signInWithPopup","signOut","createUserWithEmailAndPassword","signInWithEmailAndPassword","updateProfile","FacebookAuthProvider","UserContext","useHistory","useLocation","Login","newUser","setNewUser","user","setUser","isSignedIn","name","email","password","photo","loggedInUser","setLoggedInUser","history","location","app","auth","Googleprovider","Fbprovider","googleSignIn","then","result","displayName","photoURL","signedInUser","console","log","catch","error","errorCode","code","errorMessage","message","customData","credential","credentialFromError","googleSignOut","signedOutUser","success","handleBlur","event","isFieldValid","target","test","value","isPasswordValid","length","passwordHasNumber","newUserInfo","handleSubmit","res","updateUserName","userCredential","preventDefault","currentUser","fbSignIn","credentialFromResult","accessToken","color"],"mappings":"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","sourcesContent":["import React, { useContext } from 'react';\nimport { useState } from 'react';\nimport { initializeApp } from \"firebase/app\";\n// firebase.initializeApp({ ... })\nimport firebaseConfig from \"./firebase.config\";\nimport {\n    GoogleAuthProvider,\n    getAuth,\n    signInWithPopup,\n    signOut,\n    createUserWithEmailAndPassword,\n    signInWithEmailAndPassword,\n    updateProfile,FacebookAuthProvider\n} from \"firebase/auth\";\nimport { UserContext } from '../../App';\nimport { useHistory, useLocation } from 'react-router-dom';\n// import * as firebase from 'firebase/app'\n\nconst Login = () => {\n    const[newUser,setNewUser] = useState(false);\n    const [user, setUser] = useState({\n      isSignedIn: false,\n      // newUser:false,\n      name: \"\",\n      email: \"\",\n      password: \"\",\n      photo: \"\",\n    });\n\n    const [loggedInUser,setLoggedInUser] = useContext(UserContext);\n    const history = useHistory();\n    const location = useLocation();\n    const app = initializeApp(firebaseConfig);\n    const auth = getAuth(app);\n    const Googleprovider = new GoogleAuthProvider();\n    const Fbprovider = new FacebookAuthProvider();\n    const googleSignIn = () => {\n      signInWithPopup(auth, Googleprovider)\n        .then((result) => {\n          const { displayName, email, photoURL } = result.user;\n          const signedInUser = {\n            isSignedIn: true,\n            name: displayName,\n            email: email,\n            photo: photoURL,\n          };\n          setUser(signedInUser);\n          setLoggedInUser(signedInUser);\n          console.log(displayName, email, photoURL);\n  \n          // const credential = GoogleAuthProvider.credentialFromResult(result);\n          // const token = credential.accessToken;\n          // const user = result.user;\n        })\n        .catch((error) => {\n          const errorCode = error.code;\n          const errorMessage = error.message;\n          const email = error.customData.email;\n          const credential = GoogleAuthProvider.credentialFromError(error);\n          console.log(errorMessage);\n        });\n    };\n  \n    const googleSignOut = () => {\n      signOut(auth).then((result) => {\n        // const { displayName, email, photoURL } = result.user;\n        const signedOutUser = {\n          isSignedIn: false,\n          name: \"\",\n          email: \"\",\n          photo: \"\",\n          error:\"\",\n          success:false\n  \n        };\n        setUser(signedOutUser);\n      });\n    };\n  \n    const handleBlur = (event) => {\n   \n      let isFieldValid = true;\n  \n      if (event.target.name === \"email\") {\n        isFieldValid = /\\S+@\\S+\\.\\S+/.test(event.target.value);\n     \n      }\n  \n      if (event.target.name === \"password\") {\n        const isPasswordValid = event.target.value.length > 0;\n        const passwordHasNumber = /\\d{1}/.test(event.target.value);\n        isFieldValid = isPasswordValid && passwordHasNumber;\n   \n      }\n  \n      if (isFieldValid) {\n        const newUserInfo = { ...user };\n        newUserInfo[event.target.name] = event.target.value;\n        setUser(newUserInfo);\n      }\n    };\n  \n    const handleSubmit = (event) => {\n      if (newUser && user.email && user.password) {\n      \n        const auth = getAuth();\n        console.log(user.email, user.password, \"subbmit\");\n        createUserWithEmailAndPassword(auth, user.email, user.password)\n          .then(res => {\n            const newUserInfo = {...user};\n            newUserInfo.error=\"\";\n            newUserInfo.success=true;\n            setUser(newUserInfo);\n            updateUserName(user.name);\n          console.log(res)\n          })\n          .catch((error) => {\n            const newUserInfo = {...user};\n            newUserInfo.error=error.message;\n            newUserInfo.success = false;\n            setUser(newUserInfo);\n          });\n      }\n  \n  \n      if (!newUser && user.email && user.password){\n        const auth = getAuth();\n  signInWithEmailAndPassword(auth, user.email, user.password)\n    .then((userCredential) => {\n      const newUserInfo = {...user};\n      newUserInfo.error=\"\";\n      newUserInfo.success=true;\n      setUser(newUserInfo);\n      setLoggedInUser(newUserInfo);\n    })\n    .catch((error) => {\n      const newUserInfo = {...user};\n      newUserInfo.error=error.message;\n      newUserInfo.success = false;\n      setUser(newUserInfo);\n    });\n      }\n  \n  \n      event.preventDefault();\n    };\n  \n  \n    const updateUserName = name =>{\n      const auth = getAuth();\n      updateProfile(auth.currentUser, {\n        displayName: name\n      }).then(function()  {\n        console.log(\"user name updated successfully\")\n      }).catch(function(error) {\n        console.log(error);\n      });\n    }\n  \n    const fbSignIn = () =>{\n      const auth = getAuth();\n  signInWithPopup(auth, Fbprovider)\n    .then((result) => {\n      // The signed-in user info.\n      const user = result.user;\n  \n      // This gives you a Facebook Access Token. You can use it to access the Facebook API.\n      const credential = FacebookAuthProvider.credentialFromResult(result);\n      const accessToken = credential.accessToken;\n      console.log(user);\n  \n      // ...\n    })\n    .catch((error) => {\n      // Handle Errors here.\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      // The email of the user's account used.\n      const email = error.customData.email;\n      // The AuthCredential type that was used.\n      const credential = FacebookAuthProvider.credentialFromError(error);\n  \n      // ...\n    });\n    }\n  \n    return (\n      <div className=\"App\">\n        {user.isSignedIn ? (\n          <button onClick={googleSignOut}>Sign Out</button>\n        ) : (\n          <button onClick={googleSignIn}>Sign In</button>\n        )}\n        <br />\n  \n        <button onClick={fbSignIn}>Sign In Using Facebook</button>\n        {user.isSignedIn && (\n          <div>\n            <p>Welcome, {user.name}</p>\n            <p>Your email:{user.email}</p>\n            <img src={user.photo} />\n          </div>\n        )}\n  \n        {/* <h1>Our Own Authentication</h1>\n        <p>Email:{user.email}</p>\n        <p>Password:{user.password}</p> */}\n        <input type=\"checkbox\" onChange={() =>(!setNewUser(!newUser))} name=\"newUser\" id=\"\" />\n        <label htmlFor=\"newUser\">New User Sign up</label>\n        <form onSubmit={handleSubmit}>\n         {newUser && <input type=\"text\" onBlur={handleBlur} placeholder=\"Your Name\" /> }<br />\n          <input\n            type=\"text\"\n            onBlur={handleBlur}\n            name=\"email\"\n            id=\"\"\n            placeholder=\"Your Email addresss\"\n            required\n          />\n          <br />\n          <input\n            type=\"password\"\n            onChange={handleBlur}\n            name=\"password\"\n            id=\"\"\n            placeholder=\"Your Password\"\n            required\n          />\n          <br />\n          <input type=\"submit\" value={newUser ? 'Sign up': 'Sign In'} />\n        </form>\n        <p style={{ color:\"red\" }}>{user.error}</p>\n       { user.success && <p style={{ color:\"green\" }}>User {newUser ? 'created' : 'Logged In'} Created successfully</p>}\n      </div>\n    );\n  }\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}